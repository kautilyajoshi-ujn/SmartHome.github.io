
/* addons/shared_addons/modules/docs/js/docs.js */

;var doc_row_template=null;$(function(){if($('#results-container').length>0)
{var filters={};filters['dpu']=localStorage.getItem(dp_user_object_name);update_docs_table(filters,true,true);$('.api-filter-selector').change(function(){filters={};filters['dpu']=localStorage.getItem(dp_user_object_name);$('.api-filter-selector').each(function(index,element){var $element=$(element);if($element.val()!=0){filters[$element.attr('name')]=$element.val();}});update_docs_table(filters,false,false);});$('.docs.table').on('click','.toggle-revisions',function(event){var doc_id=$(this).data('doc-id');if($('.doc-revisions-'+doc_id).is(':visible')){$(this).find('i').addClass('glyphicon-plus').removeClass('glyphicon-minus');$('.doc-revisions-'+doc_id).mkHideThis();}else{$(this).find('i').removeClass('glyphicon-plus').addClass('glyphicon-minus');$('.doc-revisions-'+doc_id).mkShowThis();}});}
if($('#validate-dealer-form').length>0){$('username').focus();$('#validate-dealer-form').submit(function(e){e.preventDefault();$('#err-container').css('display','none');$('#form-err').html('');$('#LoginButton').html('<i class="fal fa-circle-notch fa-spin" aria-hidden="true"></i>');$('#LoginButton').prop('disabled',true);$.ajax({type:'POST',dataType:'json',contentType:'application/x-www-form-urlencoded',url:$(this).attr('action'),data:{username:$('#username').val(),password:$('#password').val(),primary_portal:primary_portal,ignore_portal:ignore_portal},success:function(data){data=JSON.parse(JSON.stringify(data));if(data.status==1){localStorage.setItem(dp_user_object_name,JSON.stringify(data.user));location.reload();}
else{$('#form-err').html(data.message);$('#err-container').css('display','block');}
$('#LoginButton').html('<i class="fal fa-arrow-right"></i>');$('#LoginButton').prop('disabled',false);},error:function(err){alert('Could not establish a connnection to the server. Please contact the webteam');}});});}});function update_docs_table(body_array,refresh_selects,refresh_category_listing){$('#dropdown').css('opacity',.3);body_array.exclude_doc_file_text=true;$.post('/docs/api',body_array,function(return_data){if(return_data.success){if(refresh_selects){update_selects(return_data);}
if(!refresh_selects||!refresh_category_listing){$('#initial-info').addClass('hidden');$('#results-container').removeClass('hidden');}
$('#dropdown').css('opacity',1);if(return_data.docs.length==0){$('.table.docs .body').html('');$('#doc_not_found').removeClass('hidden');}else{$('.table.docs .body').html('');$('#doc_not_found').not('.hidden').addClass('hidden');if(Array.isArray(return_data.docs)){var dataTrack='Click-';var dataTrackCat='Download';if(return_data.has_dealer_content){$('#dealer-content-message').css('display','block');}
return_data.docs.forEach(function(element){var documentName=(typeof(element.display_name)!='undefined'&&element.display_name)?element.display_name:element.product_name+' '+element.doc_type;var imageColHtml=document.createElement('div');imageColHtml.className='col-xs-4 col-sm-2';var docLink=document.createElement('a');docLink.href=element.latest_link;docLink.target='_blank';docLink.className='a-track'
docLink.setAttribute('data-track-category',dataTrackCat);docLink.setAttribute('data-track',dataTrack+element.latest_revision_format);docLink.setAttribute('data-track-label',documentName+' (latest revision - '+element.latest_revision+')');var docLinkTitleCol=docLink.cloneNode(true);docLinkTitleCol.innerHTML=documentName+' ('+(element.language_name==''?'English':element.language_name)+')';var imageTag=document.createElement('img');imageTag.src=element.thumb_url;imageTag.className='block';docLink.appendChild(imageTag);imageColHtml.appendChild(docLink);var titleColHtml=document.createElement('div');titleColHtml.className='col-xs-8 col-sm-7';titleColHtml.style.paddingLeft='30px';var revisionsContainer=document.createElement('div');revisionsContainer.className='revisions-container doc-revisions-'+element.id+' hidden';element.revisions.forEach(function(revisionElement){var t=revisionElement.start_date.split(/[- :]/);var date=t[0]+'-'+t[1]+'-'+t[2];var revisionLinkRow=document.createElement('p');revisionLinkRow.style.margin='0 0 0 25px';var revisionLink=document.createElement('a');revisionLink.href=revisionElement.link;revisionLink.target='_blank';revisionLink.className='a-track'
revisionLink.setAttribute('data-track-category',dataTrackCat);revisionLink.setAttribute('data-track',dataTrack+revisionElement.doc_format);revisionLink.setAttribute('data-track-label',documentName+' ('+(revisionElement.revision==element.latest_revision?'latest ':'')+'revision - '+revisionElement.revision+')');revisionLink.innerHTML='Revision '+revisionElement.revision+' - '+date;revisionLinkRow.appendChild(revisionLink);revisionsContainer.appendChild(revisionLinkRow);});titleColHtml.append(docLinkTitleCol);titleColHtml.appendChild(revisionsContainer);var optionsColHtml=document.createElement('div');optionsColHtml.className='col-xs-12 col-sm-3 text-right';var downloadIcon=document.createElement('i');downloadIcon.className='fal fa-arrow-to-bottom';var showRevisionsIcon=document.createElement('i');showRevisionsIcon.className='fal fa-chevron-down';var showRevisionsLink=document.createElement('a');showRevisionsLink.href='javascript:;';showRevisionsLink.className='c4btn transparent text-dark toggle-revisions';showRevisionsLink.title='View Revisions';showRevisionsLink.setAttribute('data-doc-id',element.id);showRevisionsLink.appendChild(showRevisionsIcon);var docLinkOptionsCol=document.createElement('a');docLinkOptionsCol.href=element.latest_link;docLinkOptionsCol.target='_blank';docLinkOptionsCol.className='a-track'
docLinkOptionsCol.setAttribute('data-track-category',dataTrackCat);docLinkOptionsCol.setAttribute('data-track',dataTrack+element.latest_revision_format);docLinkOptionsCol.setAttribute('data-track-label',documentName+' (latest revision - '+element.latest_revision+')');docLinkOptionsCol.appendChild(downloadIcon);optionsColHtml.append(docLinkOptionsCol);optionsColHtml.append(showRevisionsLink);var rowHtml=document.createElement('div');rowHtml.className='row';rowHtml.appendChild(imageColHtml);rowHtml.appendChild(titleColHtml);rowHtml.appendChild(optionsColHtml);$('.table.docs .body').append(rowHtml);});attachLinkTracking();}}}});}
function update_selects(return_data){var products=return_data.available_filters.products;clear_select('products');add_options_to_select(filterByProductCopy,products,'products');var types=return_data.available_filters.types;clear_select('types');add_options_to_select(filterByDocTypeCopy,types,'types');var languages=return_data.available_filters.languages;clear_select('languages');add_options_to_select(filterByLanguageCopy,languages,'languages');}
function clear_select(select_id)
{var dd_select=document.getElementById(select_id);if(dd_select!=null)
{for(option in dd_select.options)
{dd_select.options.remove(0);}}}
function add_options_to_select(select_text,options,select_id)
{var dd_select=document.getElementById(select_id);if(dd_select!=null)
{dd_select.options.add(new Option(select_text,0));for(var slug in options)
{dd_select.options.add(new Option(options[slug],slug));}}}
